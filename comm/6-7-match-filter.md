---
layout: post
title: 匹配滤波器
---

有了相关接收机，我们就离“用滤波器实现最佳接收机”不远了。为什么这么说呢？让我们看看相关的数学表达式，它是不是可以用一个 $$h(t)$$ 的滤波器实现？可以吧？我们知道，信号 $$r(t)$$ 经过一个冲击响应为 $$h(t)$$ 的滤波器，输出信号就相当于 $$r(t)$$ 和 $$h(t)$$ 的卷积，即把 $$h(t)$$ 翻转、平移后，和 $$r(t)$$ 做相关，对不对？所以，如果 $$h(t)$$ 翻转、平移后，就是 s(t)，那么，我们是不是就实现“相关接收机”了？

循着这个思路，我们建立“用滤波器实现最佳接收机”的理论模型。首先，我们定义什么是“最佳”。因为我们现在在信号与系统的框架下分析这个问题，所以，我们定义一个“最佳”指标是“最大瞬时输出信噪比”，即：我们在取样判决的这个“瞬时”，接收机的输出信噪比最大。

我们在频域上进行分析。我们首先将信号功率和噪声功率都写成 $$S(f)$$ 和 $$H(f)$$ 的形式，获得目标函数：信号功率在取样时刻的瞬时值和噪声平均功率的比值。确定优化目标是让这个值最大。我们然后利用施瓦茨不等式的极值条件，获得让目标函数最大的 $$H(f)$$。我们最后对 $$H(f)$$ 做傅立叶反变换，就得到了滤波器的冲激函数 $$h(t)$$。它的形式如下：

$$h(t) = s(t_0 - t)$$

上式表明：让接收机采样时刻输出瞬时信噪比最大的滤波器的冲激响应函数，就是 $$s(t)$$ 的反转，然后平移。平移的距离，正好是它的取样时刻。

我们将具有这种 $$h(t)$$ 的接收滤波器，称为“匹配滤波器”，因为它和 $$s(t)$$ “匹配”。

那么，基于匹配滤波器的接收机是不是最佳接收机呢？基于 $$h(t) = s(t_0 - t)$$，我们写出它们的输出的数学形式，就会发现它们是等价的。所以，基于匹配滤波器的接收机就是最佳接收机。所以，我们现在就证明了：以下三个准则的接收机，是等价的：

1. 符合 MAP 准则的“理想接收机”
2. 符合 ML 准则（在加性高斯噪声的前提下，被称为“最小距离准则”，“最小均方误差准则”）的“相关接收机”
3. 符号“最大输出信噪比准则”的“匹配滤波器”接收机。

注意，“最小距离准则”，“最小均方误差准则”是 ML 准则的一种形式。它们自己不是独立的一种准则哦。

我们接着做 $$h(t)$$ 和 $$s(t)$$ 的卷积，就能发现，它的输出，就是 $$s(t)$$ 的自相关函数的平移。平移的距离，也是它的取样时刻。大家知道，自相关函数在 $$t = 0$$ 时是最大的，因此，这个输出，确实是在取样时刻取最大值。

那么这个取样时刻的瞬时信噪比到底多大呢？我们在频域对它进行计算，就能得到，它等于一个特别简单的值：

$$\frac{2E}{n_0}$$

上式中的 $$E$$ 是 $$s(t)$$ 信号在它的一个符号周期内的能量。

请大家一定要掌握上面这个式子。它极为重要。为什么呢？有两个原因：首先，它反映了我们特别关心的数字通信系统的“可靠性”。其次，它“通用”。大家看，我们一路推导下来，没有对 $$s(t)$$ 做任何限定，对吧？所以，它对我们前面学过的所有数字通信系统都适用：各种基带、频带系统。因此，对任何数字通信系统，我们就把它的符号能量算一下，就可以用这个式子，得到它的最佳接收机的输出时的瞬时信噪比。所以，请大家一定要牢记它。

那么，这个取样时间的长度，也就是说：$$s(t)$$ 反转后，平移的长度，怎么确定呢？首先，$$s(t)$$ 反转，平移后，就得到 $$h(t)$$。因为 $$h(t)$$ 得是物理可实现的，所以，我们得移动得让它在 $$t < 0$$ 时 $$h(t) = 0$$。其次，因为我们要在这个时刻采样，因此，它越小越好，这样我们在接收端就能尽早完成接收的工作，减少通信延时。基于这两个原则，我们就能获得给定 $$s(t)$$ 的取样时间长度。详见课程 PPT，并请认真完成 PPT 里的练习。

我们也要能够画出匹配滤波接收机的工作原理图。详见 PPT 里的例题。

下面是 Quiz：

1. 什么是最大输出信噪比准则？
1. 什么是匹配滤波器法最佳接收机？画出其框图，并解释每一个模块的作用。
1. 写出匹配滤波器在抽样时刻 $$t_0$$ 时的输出信号瞬时功率与噪声功率的数学表达式，解释其物理意义
1. 匹配滤波器在抽样时刻 $$t_0$$ 时的输出信号瞬时功率与噪声功率的比值，在什么情况下能够取得最大值？该最大值是多少？
1. 匹配滤波器的冲激响应函数 $$h(t)$$ 和发送信号 $$s(t)$$ 是什么关系？
1. $$t_0$$ 如何确定？这样有什么好处？
1. 匹配滤波器的输入信号为 $$s(t)$$ 时，输出信号和 $$s(t)$$ 的自相关函数是什么关系？该输出信号在 $$t_0 = T_s$$ 时，是什么值？该值的物理意义是？
1. 为什么说匹配滤波器接收机等价于相关接收机？
1. 为什么说匹配滤波器接收机是最佳接收机？
11. 匹配滤波器最佳接收机只适用于数字频带传输系统，不适用于数字基带传输系统，这一说法对吗？为什么？
11. 请写出匹配滤波器接收机的框图，解释每一个模块的作用。
11. 请画出M进制匹配滤波器接收机的框图，并解释每一个模块的作用。
11. 匹配滤波器也可以匹配正交数字调制系统的基信号，请画出这种匹配滤波器接收机的框图，并解释每一个模块的作用。

<br/>

|[Index](./) | [Previous](6-5-correlation) | [Next](6-9-error)|
